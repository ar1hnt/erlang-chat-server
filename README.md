# Чат-сервер на Erlang

OTP‑приложение: TCP‑чат с комнатами, мониторингом подключений, простым GUI‑клиентом на Python Tkinter.

## Сборка

```
rebar3 compile
```

## Запуск сервера

```
rebar3 shell
```

Приложение поднимет listener на порту `5555`.

## Клиент (telnet)

```
telnet localhost 5555
```

Команды:

- `/nick NAME` — установить ник; при повторном входе с тем же ником восстановятся комнаты
- `/join ROOM` — вступить в комнату и сделать её активной
- `/leave ROOM` — выйти из комнаты (если это активная — вернёт в `main`)
- `/help` — показать команды

Обычные сообщения отправляются в активную комнату. Свои сообщения помечаются как `Вы: ...`, сообщения других — как `[дата и время] (комната) имя_клиента: ...`.

Кириллица поддерживается (UTF‑8).

## GUI‑клиент (Python + Tkinter)

Требуется Python 3 с Tkinter. В отдельном терминале:

```
python3 clients/python/tk_chat_client.py
```

Клиент запросит ник и подключится к `localhost:5555`. На разрыв соединения пытается переподключиться и отправляет `/nick` после восстановления.

## Структура OTP

- `chat_app` — application behaviour, стартует `chat_sup`.
- `chat_sup` — корневой супервизор: `room_manager`, `client_sup`, `listener`.
- `client_sup` — динамический супервизор клиентов (simple_one_for_one).
- `listener` — TCP‑listener, принимает соединения, передаёт сокет клиентскому процессу.
- `client_proc` — процесс клиента: приём команд/сообщений, echo, отправка в `room_manager`.
- `room_manager` — комнаты, мониторинг клиентов, хранение никнеймов и комнат для восстановления, распределённая рассылка.

## Примечания

- По умолчанию активная комната — `main`.
